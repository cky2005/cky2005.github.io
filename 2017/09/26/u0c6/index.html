<!-- build time:Fri Sep 29 2017 18:16:12 GMT+0800 (中国标准时间) --><!DOCTYPE HTML><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="chrome=1"><div class="r_menu"><a href="/index.html"><i class="icon-home icon-2x"></i></a></div><div class="r1_menu"><a href="#" onclick="history.back()"><i class="icon-circle-arrow-left icon-2x"></i></a></div><div class="r2_menu"><a href="#" onclick="window.history.forward()"><i class="icon-circle-arrow-right icon-2x"></i></a></div><style type="text/css">a:hover{color:#b00}#squ-side{width:70px;height:auto;margin:0;position:fixed;background:0 0;z-index:999999;overflow:hidden;top:50%;left:-40px;-webkit-transition:.5s ease-in-out;-moz-transition:.5s ease-in-out;-o-transition:.5s ease-in-out}.squ-sidec{float:left;width:30px;border:2px solid #ccc;border-radius:.5em .5em .5em .5em;box-shadow:0 5px 5px #565656;-webkit-box-shadow:0 5px 5px #565656;-moz-box-shadow:0 5px 5px #565656;-o-box-shadow:0 5px 5px #565656}.squ-sideb{float:right;width:25px}.squ-sideb .b{width:22px;height:20px;border-radius:50%;text-align:center;box-shadow:0 5px 5px #565656;-webkit-box-shadow:0 5px 5px #565656;-moz-box-shadow:0 5px 5px #565656;-o-box-shadow:0 5px 5px #565656}#squ-side:hover{left:0}#squ-side:hover .squ-sideb .b{opacity:0;filter:alpha(opacity=0)}</style><div id="squ-side"><div class="squ-sidec"><div style="text-align:left"><a href="https://www.weibo.com"><i class="icon-weibo icon-2x"></i></a><br><a href="https://www.tumblr.com"><i class="icon-tumblr icon-2x"></i></a><br><a href="https://www.twitter.com"><i class="icon-twitter-sign icon-2x"></i></a><br><a href="/about/index.html"><i class="icon-tags icon-2x"></i></a></div></div><div class="squ-sideb"><div class="b">?</div></div></div><title>$$R多用户版安装教程 | 唔多阁</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="author" content="(^_^)"><meta name="description" content="SsR 多用户版安装教程 #"><meta name="description" content="SsR 多用户版安装教程 #"><meta property="og:type" content="article"><meta property="og:title" content="$$R多用户版安装教程"><meta property="og:url" content="https://www.233666.org/2017/09/26/u0c6/index.html"><meta property="og:site_name" content="唔多阁"><meta property="og:description" content="SsR 多用户版安装教程 #"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2017-09-26T04:09:38.838Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="$$R多用户版安装教程"><meta name="twitter:description" content="SsR 多用户版安装教程 #"><link rel="icon" type="image/x-icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/style.css"></head></html><body><div class="wrapper"><header id="header"><div class="title"><h1><a href="/">唔多阁</a></h1><p><a href="/">(学习笔记,备忘,纯属复制粘贴,无技术含量)</a></p></div><nav class="nav"><ul></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div class="content"><article class="post"><header><div class="icon"></div><a href="/2017/09/26/u0c6/"><time datetime="2017-09-26T04:00:17.000Z">2017-09-26</time></a><h1 class="title">$$R多用户版安装教程</h1></header><div class="entry"><h3 id="SsR-多用户版安装教程"><a href="#SsR-多用户版安装教程" class="headerlink" title="SsR 多用户版安装教程 #"></a>SsR 多用户版安装教程 #<a id="more"></a></h3><p>以下命令均以root用户执行，或sudo方式执行</p><h3 id="基本库安装"><a href="#基本库安装" class="headerlink" title="基本库安装"></a>基本库安装</h3><p>centos：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">yum install python-setuptools &amp;&amp; easy_install pip</div><div class="line">yum install git</div></pre></td></tr></table></figure><p></p><p>ubuntu/debian：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">apt-get install python-pip</div><div class="line">apt-get install git</div></pre></td></tr></table></figure><p></p><h3 id="获取源代码"><a href="#获取源代码" class="headerlink" title="获取源代码"></a>获取源代码</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">git clone -b master https://github.com/wuming2018/test.git</div><div class="line">mv test/ /usr/local/shadowsocksr</div></pre></td></tr></table></figure><p>执行完毕后安装目录为/usr/local/shadowsocksr,其中根目录的是多用户版,即数据库版,个人用户请忽略这个,子目录中的是单用户版,即/usr/local/shadowsocksr/shadowsocks</p><h3 id="服务端配置"><a href="#服务端配置" class="headerlink" title="服务端配置"></a>服务端配置</h3><p>进入根目录初始化配置(假设根目录在<code>/usr/local/shadowsocksr</code>，如果不是，命令需要适当调整)：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cd /usr/local/shadowsocksr</div><div class="line">bash initcfg.sh</div></pre></td></tr></table></figure><p></p><h3 id="多用户配置文件"><a href="#多用户配置文件" class="headerlink" title="多用户配置文件"></a>多用户配置文件</h3><p>手动编辑配置文件<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">vi mudb.json</div></pre></td></tr></table></figure><p></p><h4 id="示例-下面有3个用户的配置文件"><a href="#示例-下面有3个用户的配置文件" class="headerlink" title="示例,下面有3个用户的配置文件"></a>示例,下面有3个用户的配置文件</h4><p><code>1081</code> 端口:1081,加密:aes-256-cfb,协议:auth_sha1_v4_compatible,混淆:http_simple_compatible,密码:1234567<br><code>1082</code> 端口:1082,加密:aes-256-cfb,协议:auth_sha1_v4_compatible,混淆:tls1.2_ticket_auth_compatible,密码:1234567<br><code>1083</code> 端口:1083,加密:aes-256-cfb,协议:auth_sha1_v4_compatible,混淆:tls1.2_ticket_auth_compatible,密码:1234567<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[</div><div class="line">    &#123;</div><div class="line">        &quot;d&quot;: 0,</div><div class="line">        &quot;enable&quot;: 1,</div><div class="line">        &quot;forbidden_port&quot;: &quot;&quot;,</div><div class="line">        &quot;port&quot;: 1081,</div><div class="line">        &quot;method&quot;: &quot;aes-256-cfb&quot;,</div><div class="line">        &quot;passwd&quot;: &quot;1234567&quot;,</div><div class="line">        &quot;protocol&quot;: &quot;auth_sha1_v4_compatible&quot;,</div><div class="line">        &quot;protocol_param&quot;: &quot;&quot;,</div><div class="line">        &quot;obfs&quot;: &quot;http_simple_compatible&quot;,</div><div class="line">        &quot;speed_limit_per_con&quot;: 0,</div><div class="line">        &quot;speed_limit_per_user&quot;: 0,</div><div class="line">        &quot;transfer_enable&quot;: 900727656415232,</div><div class="line">        &quot;u&quot;: 0,</div><div class="line">        &quot;user&quot;: &quot;1081&quot;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        &quot;d&quot;: 0,</div><div class="line">        &quot;enable&quot;: 1,</div><div class="line">        &quot;forbidden_port&quot;: &quot;&quot;,</div><div class="line">        &quot;port&quot;: 1082,</div><div class="line">        &quot;method&quot;: &quot;aes-256-cfb&quot;,</div><div class="line">        &quot;passwd&quot;: &quot;1234567&quot;,</div><div class="line">        &quot;protocol&quot;: &quot;auth_sha1_v4_compatible&quot;,</div><div class="line">        &quot;protocol_param&quot;: &quot;&quot;,</div><div class="line">        &quot;obfs&quot;: &quot;tls1.2_ticket_auth_compatible&quot;,</div><div class="line">        &quot;speed_limit_per_con&quot;: 0,</div><div class="line">        &quot;speed_limit_per_user&quot;: 0,</div><div class="line">        &quot;transfer_enable&quot;: 900727656415232,</div><div class="line">        &quot;u&quot;: 0,</div><div class="line">        &quot;user&quot;: &quot;1082&quot;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        &quot;d&quot;: 0,</div><div class="line">        &quot;enable&quot;: 1,</div><div class="line">        &quot;forbidden_port&quot;: &quot;&quot;,</div><div class="line">        &quot;port&quot;: 1083,</div><div class="line">        &quot;method&quot;: &quot;aes-256-cfb&quot;,</div><div class="line">        &quot;passwd&quot;: &quot;1234567&quot;,</div><div class="line">        &quot;protocol&quot;: &quot;auth_sha1_v4_compatible&quot;,</div><div class="line">        &quot;protocol_param&quot;: &quot;&quot;,</div><div class="line">        &quot;obfs&quot;: &quot;tls1.2_ticket_auth_compatible&quot;,</div><div class="line">        &quot;speed_limit_per_con&quot;: 0,</div><div class="line">        &quot;speed_limit_per_user&quot;: 0,</div><div class="line">        &quot;transfer_enable&quot;: 900727656415232,</div><div class="line">        &quot;u&quot;: 0,</div><div class="line">        &quot;user&quot;: &quot;1083&quot;</div><div class="line">    &#125;</div><div class="line">]</div></pre></td></tr></table></figure><p></p><p>可以按自己喜好自行修改/添加/删除<br>为了方便,上面的示例已建立一个现成的mudb_json,可以在安装目录下执行这个命令使用这个现成的:<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">// 此命令的意思:删除现存的mudb.json,删除成功后,复制mudb_json为mudb.json</div><div class="line">rm mudb.json &amp;&amp; cp mudb_json mudb.json</div></pre></td></tr></table></figure><p></p><p>配置文件说明:<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&quot;d&quot;: 1215596,   //下载字节数</div><div class="line">&quot;enable&quot;: 1,        //开启这个用户</div><div class="line">&quot;forbidden_port&quot;: &quot;&quot;,   //禁止访问端口</div><div class="line">&quot;port&quot;: 1083,   //端口</div><div class="line">&quot;method&quot;: &quot;aes-128-ctr&quot;,    //加密方式</div><div class="line">&quot;passwd&quot;: &quot;1234567&quot;,    //密码</div><div class="line">&quot;protocol&quot;: &quot;auth_sha1_v4_compatible&quot;,  //协议</div><div class="line">&quot;protocol_param&quot;: &quot;&quot;,   //端口同一时间能链接的客户端数量</div><div class="line">&quot;obfs&quot;: &quot;tls1.2_ticket_auth_compatible&quot;,    //混淆</div><div class="line">&quot;speed_limit_per_con&quot;: 0,   //端口单用户限速</div><div class="line">&quot;speed_limit_per_user&quot;: 0,  //端口总用户限速</div><div class="line">&quot;transfer_enable&quot;: 900727656415232, //流量限制(单位:字节数) (5g=5368709120) (100g=107374182400)</div><div class="line">&quot;u&quot;: 147824,    //上传字节数</div><div class="line">&quot;user&quot;: &quot;1083&quot;  //用户名</div></pre></td></tr></table></figure><p></p><h4 id="参考资料-https-breakwa11-blogspot-com-2017-01-shadowsocksr-mu-html"><a href="#参考资料-https-breakwa11-blogspot-com-2017-01-shadowsocksr-mu-html" class="headerlink" title="参考资料 : https://breakwa11.blogspot.com/2017/01/shadowsocksr-mu.html"></a>参考资料 : <a href="https://breakwa11.blogspot.com/2017/01/shadowsocksr-mu.html" target="_blank" rel="external">https://breakwa11.blogspot.com/2017/01/shadowsocksr-mu.html</a></h4><p>或者通过使用脚本<code>mujson_mgr.py</code>添加端口及相应的加密、协议、混淆等配置，具体方法通过执行以下命令查看该脚本的说明及提示：<br><code>python mujson_mgr.py</code><br>示例:增加一个用户:001, 端口:1234, 密码:1234567, 加密方式:aes-256-cfb, 协议:auth_sha1_v4,混淆:http_simple<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">python mujson_mgr.py -a -u &quot;001&quot; -p 1234 -k 1234567 -m aes-256-cfb -O auth_sha1_v4 -o http_simple</div></pre></td></tr></table></figure><p></p><p>示例运行结果:<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">### add user info</div><div class="line">    user : 001</div><div class="line">    port : 1234</div><div class="line">    method : aes-256-cfb</div><div class="line">    passwd : 1234567</div><div class="line">    protocol : auth_sha1_v4</div><div class="line">    obfs : http_simple</div><div class="line">    transfer_enable : 8388608.0  G Bytes</div><div class="line">    u : 0</div><div class="line">    d : 0</div><div class="line">    ssr://xxx.xxx.xxx.xxx:1234:auth_sha1_v4:aes-256-cfb:http_simple:xxxxxxxxx</div><div class="line">    ssr://xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</div></pre></td></tr></table></figure><p></p><h3 id="服务端运行与停止"><a href="#服务端运行与停止" class="headerlink" title="服务端运行与停止"></a>服务端运行与停止</h3><p>后台运行（无log，ssh窗口关闭后也继续运行）</p><p><code>./run.sh</code></p><p>后台运行（输出log，ssh窗口关闭后也继续运行）</p><p><code>./logrun.sh</code></p><p>后台运行时查看运行情况</p><p><code>./tail.sh</code></p><p>停止运行</p><p><code>./stop.sh</code></p><p>注：通过脚本运行默认日志会保存在根目录的ssserver.log，可手动查看。</p><h3 id="开机自启动"><a href="#开机自启动" class="headerlink" title="开机自启动"></a>开机自启动</h3><p>systemd脚本，适用于CentOS/RHEL7以上，Ubuntu 15以上，Debian8以上,安装目录为/usr/local/shadowsocksr<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cp /usr/local/shadowsocksr/shadowsocksr.service /etc/systemd/system/shadowsocksr.service</div><div class="line">systemctl enable shadowsocksr.service &amp;&amp; systemctl start shadowsocksr.service</div></pre></td></tr></table></figure><p></p><p>低版本可以去参考 System startup script : <a href="https://github.com/wuming2018/test/blob/master/System-startup-script.md" target="_blank" rel="external">https://github.com/wuming2018/test/blob/master/System-startup-script.md</a></p><h3 id="其它异常"><a href="#其它异常" class="headerlink" title="其它异常"></a>其它异常</h3><p>如果你的服务端python版本在2.6以下，那么必须更新python到2.6.x或2.7.x版本</p><p><del>其它参见 <a href="https://github.com/breakwa11/shadowsocks-rss/wiki/ulimit" target="_blank" rel="external">https://github.com/breakwa11/shadowsocks-rss/wiki/ulimit</a></del></p></div><footer><div class="clearfix"></div></footer></article></div></div><footer id="footer"><div class="copyright">&copy; 2017 <a href="/">(^_^)</a></div><div class="theme-copyright">Theme by <a href="https://github.com/orderedlist" target="_blank">orderedlist</a> | Redesign by <a href="http://heroicyang.com/" target="_blank">Heroic Yang</a></div><div class="clearfix"></div></footer><script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/all.js"></script></body><!-- rebuild by neat -->