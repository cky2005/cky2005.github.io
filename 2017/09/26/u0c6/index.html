<!-- build time:Wed Oct 25 2017 11:28:16 GMT+0800 (中国标准时间) --><!DOCTYPE HTML><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="chrome=1"><div id="squ-side"><div class="squ-sidec"><div style="text-align:left"><a href="javascript:scroll(0,0)"><font size="6">▲</font></a> <a href="/about/index.html"><i class="icon-copy icon-2x"></i></a> <a href="/index.html"><i class="icon-home icon-2x"></i></a></div></div><div class="squ-sideb"><div class="b">?</div></div></div><title>$$R多用户版安装教程 | 唔多阁</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="author" content="(^_^)"><meta name="description" content="$$R 多用户版安装教程"><meta name="description" content="$$R 多用户版安装教程"><meta property="og:type" content="article"><meta property="og:title" content="$$R多用户版安装教程"><meta property="og:url" content="https://www.233666.org/2017/09/26/u0c6/index.html"><meta property="og:site_name" content="唔多阁"><meta property="og:description" content="$$R 多用户版安装教程"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2017-10-24T15:58:23.748Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="$$R多用户版安装教程"><meta name="twitter:description" content="$$R 多用户版安装教程"><link rel="icon" type="image/x-icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/style.css"></head></html><body><div class="wrapper"><header id="header"><div class="title"><h1><a href="/">唔多阁</a></h1><p><a href="/">(学习笔记,备忘,纯属复制粘贴,无技术含量)</a></p></div><nav class="nav"><ul></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div class="content"><article class="post"><header><div class="icon"></div><a href="/2017/09/26/u0c6/"><time datetime="2017-09-26T05:00:17.000Z">2017-09-26</time></a><h1 class="title">$$R多用户版安装教程</h1></header><div class="entry"><h3 id="R-多用户版安装教程"><a href="#R-多用户版安装教程" class="headerlink" title="$$R 多用户版安装教程 "></a>$$R 多用户版安装教程<a id="more"></a></h3><p>以下命令均以root用户执行，或sudo方式执行</p><h3 id="基本库安装"><a href="#基本库安装" class="headerlink" title="基本库安装"></a>基本库安装</h3><p>(1) centos 系统用yum：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">yum install python-setuptools &amp;&amp; easy_install pip</div><div class="line">yum install git</div></pre></td></tr></table></figure><p></p><p>(2) ubuntu/debian 系统用apt-get：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">apt-get install python-pip</div><div class="line">apt-get install git</div></pre></td></tr></table></figure><p></p><h3 id="获取源代码"><a href="#获取源代码" class="headerlink" title="获取源代码"></a>获取源代码</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">git clone -b master https://github.com/wuming2018/test.git</div><div class="line">mv test/ /usr/local/shadowsocksr</div></pre></td></tr></table></figure><p>执行完毕后安装目录为/usr/local/shadowsocksr,其中根目录的是多用户版,即数据库版,个人用户请忽略这个,子目录中的是单用户版,即/usr/local/shadowsocksr/shadowsocks</p><h3 id="服务端配置"><a href="#服务端配置" class="headerlink" title="服务端配置"></a>服务端配置</h3><p>进入根目录初始化配置(假设根目录在<code>/usr/local/shadowsocksr</code>，如果不是，命令需要适当调整)：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cd /usr/local/shadowsocksr</div><div class="line">bash initcfg.sh</div></pre></td></tr></table></figure><p></p><h3 id="多用户配置文件"><a href="#多用户配置文件" class="headerlink" title="多用户配置文件"></a>多用户配置文件</h3><h4 id="1-手动编辑配置文件"><a href="#1-手动编辑配置文件" class="headerlink" title="(1)手动编辑配置文件"></a>(1)手动编辑配置文件</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">vi /usr/local/shadowsocksr/mudb.json</div></pre></td></tr></table></figure><p><code>示例:</code><br>用户名:”1081”,端口:1081,加密:aes-256-cfb,协议:auth_sha1_v4_compatible,混淆:http_simple_compatible,密码:1234567<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[</div><div class="line">    &#123;</div><div class="line">        &quot;d&quot;: 0,</div><div class="line">        &quot;enable&quot;: 1,</div><div class="line">        &quot;forbidden_port&quot;: &quot;&quot;,</div><div class="line">        &quot;port&quot;: 1081,</div><div class="line">        &quot;method&quot;: &quot;aes-256-cfb&quot;,</div><div class="line">        &quot;passwd&quot;: &quot;1234567&quot;,</div><div class="line">        &quot;protocol&quot;: &quot;auth_sha1_v4_compatible&quot;,</div><div class="line">        &quot;protocol_param&quot;: &quot;&quot;,</div><div class="line">        &quot;obfs&quot;: &quot;http_simple_compatible&quot;,</div><div class="line">        &quot;speed_limit_per_con&quot;: 0,</div><div class="line">        &quot;speed_limit_per_user&quot;: 0,</div><div class="line">        &quot;transfer_enable&quot;: 900727656415232,</div><div class="line">        &quot;u&quot;: 0,</div><div class="line">        &quot;user&quot;: &quot;1081&quot;</div><div class="line">    &#125;</div><div class="line">]</div></pre></td></tr></table></figure><p></p><p><code>配置文件说明</code>:<br></p><figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="string">"d"</span>: <span class="number">1215596</span>,   <span class="comment">//下载字节数</span></div><div class="line"><span class="string">"enable"</span>: <span class="number">1</span>,        <span class="comment">//开启这个用户</span></div><div class="line"><span class="string">"forbidden_port"</span>: <span class="string">""</span>,   <span class="comment">//禁止访问端口</span></div><div class="line"><span class="string">"port"</span>: <span class="number">1083</span>,   <span class="comment">//端口</span></div><div class="line"><span class="string">"method"</span>: <span class="string">"aes-128-ctr"</span>,    <span class="comment">//加密方式</span></div><div class="line"><span class="string">"passwd"</span>: <span class="string">"1234567"</span>,    <span class="comment">//密码</span></div><div class="line"><span class="string">"protocol"</span>: <span class="string">"auth_sha1_v4_compatible"</span>,  <span class="comment">//协议</span></div><div class="line"><span class="string">"protocol_param"</span>: <span class="string">""</span>,   <span class="comment">//端口同一时间能链接的客户端数量</span></div><div class="line"><span class="string">"obfs"</span>: <span class="string">"tls1.2_ticket_auth_compatible"</span>,    <span class="comment">//混淆</span></div><div class="line"><span class="string">"speed_limit_per_con"</span>: <span class="number">0</span>,   <span class="comment">//端口单用户限速</span></div><div class="line"><span class="string">"speed_limit_per_user"</span>: <span class="number">0</span>,  <span class="comment">//端口总用户限速</span></div><div class="line"><span class="string">"transfer_enable"</span>: <span class="number">900727656415232</span>, <span class="comment">//流量限制(单位:字节数) (5g=5368709120) (100g=107374182400)</span></div><div class="line"><span class="string">"u"</span>: <span class="number">147824</span>,    <span class="comment">//上传字节数</span></div><div class="line"><span class="string">"user"</span>: <span class="string">"1083"</span>  <span class="comment">//用户名</span></div></pre></td></tr></table></figure><p></p><p><code>参考资料</code> : <a href="https://breakwa11.blogspot.com/2017/01/shadowsocksr-mu.html" target="_blank" rel="external">https://breakwa11.blogspot.com/2017/01/shadowsocksr-mu.html</a></p><h4 id="2-或者通过使用脚本-mujson-mgr-py-添加端口及相应的加密、协议、混淆等配置"><a href="#2-或者通过使用脚本-mujson-mgr-py-添加端口及相应的加密、协议、混淆等配置" class="headerlink" title="(2)或者通过使用脚本 mujson_mgr.py 添加端口及相应的加密、协议、混淆等配置."></a>(2)或者通过使用脚本 mujson_mgr.py 添加端口及相应的加密、协议、混淆等配置.</h4><p>脚本具体方法通过执行以下命令查看该脚本的说明及提示： <code>python mujson_mgr.py</code></p><p><code>示例:</code><br>增加一个用户:”001”,端口:1234,密码:1234567,加密方式:aes-256-cfb,协议:auth_sha1_v4,混淆:http_simple<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">python mujson_mgr.py -a -u &quot;001&quot; -p 1234 -k 1234567 -m aes-256-cfb -O auth_sha1_v4 -o http_simple</div></pre></td></tr></table></figure><p></p><p>示例运行结果:<br></p><figure class="highlight cmd"><table><tr><td class="code"><pre><div class="line">### add user info</div><div class="line">    user : <span class="number">001</span></div><div class="line">    port : <span class="number">1234</span></div><div class="line">    method : aes-<span class="number">256</span>-cfb</div><div class="line">    passwd : <span class="number">1234567</span></div><div class="line">    protocol : auth_sha1_v4</div><div class="line">    obfs : http_simple</div><div class="line">    transfer_enable : <span class="number">8388608</span>.<span class="number">0</span>  G Bytes</div><div class="line">    u : <span class="number">0</span></div><div class="line">    d : <span class="number">0</span></div><div class="line"><span class="function">    ssr://<span class="title">xxx.xxx.xxx.xxx</span>:1234:<span class="title">auth_sha1_v4:aes</span>-256-<span class="title">cfb:http_simple</span>:<span class="title">xxxxxxxxx</span></span></div><div class="line"><span class="function">    <span class="title">ssr</span>://<span class="title">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></span></div></pre></td></tr></table></figure><p></p><h3 id="服务端运行与停止"><a href="#服务端运行与停止" class="headerlink" title="服务端运行与停止"></a>服务端运行与停止</h3><p>后台运行（无log，ssh窗口关闭后也继续运行）<br><code>./run.sh</code></p><p>后台运行（输出log，ssh窗口关闭后也继续运行）<br><code>./logrun.sh</code></p><p>后台运行时查看运行情况<br><code>./tail.sh</code></p><p>停止运行<br><code>./stop.sh</code></p><p>注：通过脚本运行默认日志会保存在根目录的ssserver.log，可手动查看。</p><h3 id="开机自启动"><a href="#开机自启动" class="headerlink" title="开机自启动"></a>开机自启动</h3><p>systemd脚本，适用于CentOS/RHEL7以上，Ubuntu 15以上，Debian8以上,安装目录为/usr/local/shadowsocksr<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cp /usr/local/shadowsocksr/shadowsocksr.service /etc/systemd/system/shadowsocksr.service</div><div class="line">systemctl enable shadowsocksr.service &amp;&amp; systemctl start shadowsocksr.service</div></pre></td></tr></table></figure><p></p><p>低版本可以去参考 System startup script : <a href="https://github.com/wuming2018/test/blob/master/System-startup-script.md" target="_blank" rel="external">https://github.com/wuming2018/test/blob/master/System-startup-script.md</a></p><h3 id="其它异常"><a href="#其它异常" class="headerlink" title="其它异常"></a>其它异常</h3><p>如果你的服务端python版本在2.6以下，那么必须更新python到2.6.x或2.7.x版本</p><p><del>其它参见 <a href="https://github.com/breakwa11/shadowsocks-rss/wiki/ulimit" target="_blank" rel="external">https://github.com/breakwa11/shadowsocks-rss/wiki/ulimit</a></del></p></div><footer><div class="clearfix"></div></footer></article><div class="comments" id="comments"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7/dist/Valine.min.js"></script><script>new Valine({av:AV,el:".comments",verify:!0,app_id:"58Gw4yI8F0oqW6c8XmlSf41L-gzGzoHsz",app_key:"x9x1YOCqBJlFS4cCmNEQNhgg",placeholder:"--有问题请留言--"})</script></div></div><footer id="footer"><div class="copyright">&copy; 2017 <a href="/">(^_^)</a></div><div class="theme-copyright"><a href="javascript:scroll(0,0)">返回顶部</a></div><div class="clearfix"></div></footer><script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/all.js"></script><script type="text/javascript">$(document).ready(function(){$(document).on("click",".fold_hider",function(){$(">.fold",this.parentNode).slideToggle(),$(">:first",this).toggleClass("open")}),$("div.fold").css("display","none")})</script></body><!-- rebuild by neat -->