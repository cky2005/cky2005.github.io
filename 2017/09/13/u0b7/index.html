<!-- build time:Thu Sep 21 2017 01:49:30 GMT+0800 (中国标准时间) --><!DOCTYPE HTML><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="chrome=1"><title>简单直接的web服务器caddy | 无名小站</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="author" content="(^_^)"><meta name="description" content="使用 caddy 申请 SSL 证书 渲染 mardown 同步 Git 代码 创建文件服务器等～"><meta name="description" content="使用 caddy 申请 SSL 证书 渲染 mardown 同步 Git 代码 创建文件服务器等～"><meta property="og:type" content="article"><meta property="og:title" content="简单直接的web服务器caddy"><meta property="og:url" content="https://kai2018.ml/2017/09/13/u0b7/index.html"><meta property="og:site_name" content="无名小站"><meta property="og:description" content="使用 caddy 申请 SSL 证书 渲染 mardown 同步 Git 代码 创建文件服务器等～"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2017-09-14T13:49:43.900Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="简单直接的web服务器caddy"><meta name="twitter:description" content="使用 caddy 申请 SSL 证书 渲染 mardown 同步 Git 代码 创建文件服务器等～"><link rel="icon" type="image/x-icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/style.css"></head></html><body><div class="wrapper"><header id="header"><div class="title"><h1><a href="/">无名小站</a></h1><p><a href="/">缘来系你(学习笔记,备忘,纯属复制粘贴,无技术含量)</a></p></div><nav class="nav"><ul><li><a href="/">首页</a></li><li><a href="/about">档案</a></li></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div class="content"><article class="post"><header><div class="icon"></div><a href="/2017/09/13/u0b7/"><time datetime="2017-09-13T04:00:00.000Z">2017-09-13</time></a><h1 class="title">简单直接的web服务器caddy</h1></header><div class="entry"><p>使用 caddy 申请 SSL 证书 渲染 mardown 同步 Git 代码 创建文件服务器等～<a id="more"></a></p><p>caddy 是用go语言开发的轻巧高性能的HTTP服务器，一个文件就能运行，不再像nginx 那样需要各种编译<br><a href="https://caddyserver.com/download" target="_blank" rel="external">官方下载</a> 或者 执行:<code>curl https://getcaddy.com | bash</code> 安装</p><h4 id="HTTP域名"><a href="#HTTP域名" class="headerlink" title="HTTP域名"></a>HTTP域名</h4><p>注意:”{“ 前面必须有空格<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">domain1.com:80, domain2.com:80 &#123;</div><div class="line">  root /home/wwwroot  # 网站目录</div><div class="line">  index index.php # 默认首页</div><div class="line"># 这里是配置</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><h4 id="HTTPS-域名"><a href="#HTTPS-域名" class="headerlink" title="HTTPS 域名"></a>HTTPS 域名</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">domain.com:443 &#123;</div><div class="line">  root /var/www/notadd/public</div><div class="line">  index index.php</div><div class="line">  tls you@163.com   # 自动申请证书，必须在外网，且域名可访问</div><div class="line">  #  如果你有证书，可如下方式配置</div><div class="line">  # tls /home/ssl/domain.com.crt /home/ssl/domain.com.key</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="配置PHP转发-（Laravel为例）"><a href="#配置PHP转发-（Laravel为例）" class="headerlink" title="配置PHP转发 （Laravel为例）"></a>配置PHP转发 （Laravel为例）</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">Laravel.com:80 &#123;</div><div class="line">        root /var/www/notadd/public</div><div class="line">        fastcgi / php-fpm:9000 php &#123;</div><div class="line">                index index.php</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        # To handle .html extensions with laravel change ext to</div><div class="line">        # ext / .html</div><div class="line"></div><div class="line">        rewrite &#123;</div><div class="line">                r .*</div><div class="line">                ext /</div><div class="line">                to /index.php?&#123;query&#125;</div><div class="line">        &#125;</div><div class="line">        gzip   # 开启gzip</div><div class="line">        browse # 开启文件浏览</div><div class="line">        #日志</div><div class="line">        log /var/log/caddy/access.log</div><div class="line">        errors /var/log/caddy/error.log</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="markdown-渲染"><a href="#markdown-渲染" class="headerlink" title="markdown 渲染"></a>markdown 渲染</h4><p>caddy 可以直接帮你把md 文件渲染成网页<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">domian.com:80 &#123;</div><div class="line">  markdown &#123;</div><div class="line">    ext /data # 不进行渲染的目录</div><div class="line">    template [name] path # 模板，可不填，使用默认</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><h4 id="自动从git-同步"><a href="#自动从git-同步" class="headerlink" title="自动从git 同步"></a>自动从git 同步</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">domian.com:80 &#123;</div><div class="line">  root /home</div><div class="line">  git https://github.com/notadd/notadd.git /var/www/ &#123;</div><div class="line">      key /home/git/domian.key # key 文件地址，公有库可忽略</div><div class="line">      interval 60 # 间隔60秒</div><div class="line">      # 或者使用钩子同步</div><div class="line">      hook /hook  password # hook地址和密钥，用于 github 等git 仓库推送更新。</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="创建文件下载服务器"><a href="#创建文件下载服务器" class="headerlink" title="创建文件下载服务器"></a>创建文件下载服务器</h4><p>需要说明的是，这个自带界面哦，还能在线编辑文件<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">domian.com:80 &#123;</div><div class="line">  root /home</div><div class="line">  filemanager</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><h4 id="一行配置，负载均衡"><a href="#一行配置，负载均衡" class="headerlink" title="一行配置，负载均衡"></a>一行配置，负载均衡</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">laravel.demo:80 &#123;</div><div class="line">    proxy / localhost:5001 localhost:5002</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="一行配置解决跨域问题："><a href="#一行配置解决跨域问题：" class="headerlink" title="一行配置解决跨域问题："></a>一行配置解决跨域问题：</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">laravel.demo:80 &#123;</div><div class="line">    root /home/wwwroot</div><div class="line">    cors</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="对于共享配置的站点，请指定多个地址："><a href="#对于共享配置的站点，请指定多个地址：" class="headerlink" title="对于共享配置的站点，请指定多个地址："></a>对于共享配置的站点，请指定多个地址：</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">localhost:8080, https://site.com, http://mysite.com &#123;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="IP过滤"><a href="#IP过滤" class="headerlink" title="IP过滤"></a>IP过滤</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">ipfilter / &#123;</div><div class="line">    rule       block</div><div class="line">    ip         212.10.15.0-255 213.10.15.0-10 5.23.4.24</div><div class="line">    blockpage  /local/data/default.html</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="网站添加BasicAuth，用户名test，密码-12345"><a href="#网站添加BasicAuth，用户名test，密码-12345" class="headerlink" title="网站添加BasicAuth，用户名test，密码 12345"></a>网站添加<code>BasicAuth</code>，用户名test，密码 12345</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">basicauth / test 12345</div></pre></td></tr></table></figure><p>当然还有更多好玩的用法，参考官方文档： <a href="https://caddyserver.com/docs" target="_blank" rel="external">https://caddyserver.com/docs</a></p><p><a href="https://docs.getcaddy.cn/" target="_blank" rel="external">中文资料</a><br><a href="https://laravel-china.org/articles/4839/use-caddy-to-apply-ssl-certificates-render-mardown-synchronize-git-code-create-file-servers-and-so-on" target="_blank" rel="external">资料</a></p></div><footer><div class="clearfix"></div></footer></article></div></div><footer id="footer"><div class="copyright">&copy; 2017 <a href="/">(^_^)</a></div><div class="theme-copyright">Theme by <a href="https://github.com/orderedlist" target="_blank">orderedlist</a> | Redesign by <a href="http://heroicyang.com/" target="_blank">Heroic Yang</a></div><div class="clearfix"></div></footer><script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/all.js"></script></body><!-- rebuild by neat -->