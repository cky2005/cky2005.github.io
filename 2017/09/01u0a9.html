<!-- build time:Wed Nov 01 2017 00:55:13 GMT+0800 (中国标准时间) --><!DOCTYPE HTML><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="chrome=1"><div id="squ-side"><div class="squ-sidec"><div style="text-align:left"><a href="javascript:scroll(0,0)"><font size="6">▲</font></a> <a href="/about/index.html"><i class="icon-copy icon-2x"></i></a> <a href="/index.html"><i class="icon-home icon-2x"></i></a></div></div><div class="squ-sideb"><div class="b">?</div></div></div><script>!function(e,t,o,c,n,a,i){e.DaoVoiceObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,a=t.createElement(o),i=t.getElementsByTagName(o)[0],a.async=1,a.src=c,a.charset="utf-8",i.parentNode.insertBefore(a,i)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/e7a17939.js","daovoice")</script><title>Linux 命令技巧 | 唔多阁</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="author" content="(^_^)"><meta name="description" content="转换密匙crt&amp;amp;key为PEM格式"><meta name="description" content="转换密匙crt&amp;amp;key为PEM格式"><meta property="og:type" content="article"><meta property="og:title" content="Linux 命令技巧"><meta property="og:url" content="https://www.233666.org/2017/09/01u0a9.html"><meta property="og:site_name" content="唔多阁"><meta property="og:description" content="转换密匙crt&amp;amp;key为PEM格式"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2017-10-21T18:07:11.026Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Linux 命令技巧"><meta name="twitter:description" content="转换密匙crt&amp;amp;key为PEM格式"><link rel="icon" type="image/x-icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/style.css"></head></html><body><div class="wrapper"><header id="header"><div class="title"><h1><a href="/">唔多阁</a></h1><p><a href="/">(学习笔记,备忘,纯属复制粘贴,无技术含量)</a></p></div><nav class="nav"><ul></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div class="content"><article class="post"><header><div class="icon"></div><a href="/2017/09/01u0a9.html"><time datetime="2017-09-01T10:50:00.000Z">2017-09-01</time></a><h1 class="title">Linux 命令技巧</h1></header><div class="entry"><h4 id="转换密匙crt-amp-key为PEM格式"><a href="#转换密匙crt-amp-key为PEM格式" class="headerlink" title="转换密匙crt&amp;key为PEM格式"></a>转换密匙crt&amp;key为PEM格式</h4><a id="more"></a><p>先转换为p12,再将p12转换为pem<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">openssl pkcs12 -export -in hostname.crt -inkey hostname.key -out hostname.p12</div><div class="line">openssl pkcs12 -in hostname.p12 -nodes -out hostname.pem</div></pre></td></tr></table></figure><p></p><p>貌似简单点的直接合拼两个文件(base64编码)在某些环境下也可以<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cat hostname.crt hostname.key &gt;hostname.pem</div></pre></td></tr></table></figure><p></p><hr><h4 id="删除一个大文件"><a href="#删除一个大文件" class="headerlink" title="删除一个大文件"></a>删除一个大文件</h4><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">&gt; /path/to/file.log</div><div class="line"><span class="comment"># 或</span></div><div class="line">: &gt; /path/to/file.log</div><div class="line"><span class="comment"># 然后删除它</span></div><div class="line">rm /path/to/file.log</div></pre></td></tr></table></figure><h4 id="还原被删除的-tmp-文件夹"><a href="#还原被删除的-tmp-文件夹" class="headerlink" title="还原被删除的 /tmp 文件夹"></a>还原被删除的 /tmp 文件夹</h4><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">mkdir /tmp</div><div class="line">chmod <span class="number">1777</span> /tmp</div><div class="line">chown root:root /tmp</div><div class="line">ls -ld /tmp</div></pre></td></tr></table></figure><h4 id="锁定一个文件夹"><a href="#锁定一个文件夹" class="headerlink" title="锁定一个文件夹"></a>锁定一个文件夹</h4><p>为了我的数据隐私，我想要锁定我文件服务器下的/downloads文件夹。因此我运行了：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">chmod 0000 /downloads</div></pre></td></tr></table></figure><p></p><p>root用户仍旧可以访问，而ls和cd命令则不工作。要还原它用：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">chmod 0755 /downloads</div></pre></td></tr></table></figure><p></p><h4 id="在vim中用密码保护文件"><a href="#在vim中用密码保护文件" class="headerlink" title="在vim中用密码保护文件"></a>在vim中用密码保护文件</h4><p>害怕root用户或者其他人偷窥你的个人文件么？尝试在vim中用密码保护，输入：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">vim +X filename</div></pre></td></tr></table></figure><p></p><p>或者，在退出vim之前使用:X 命令来加密你的文件，vim会提示你输入一个密码。</p><h4 id="清除屏幕上的乱码"><a href="#清除屏幕上的乱码" class="headerlink" title="清除屏幕上的乱码"></a>清除屏幕上的乱码</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">reset</div></pre></td></tr></table></figure><h4 id="在Linux系统中显示已知的用户信息"><a href="#在Linux系统中显示已知的用户信息" class="headerlink" title="在Linux系统中显示已知的用户信息"></a>在Linux系统中显示已知的用户信息</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">lslogins</div></pre></td></tr></table></figure><h4 id="如何删除意外在当前文件夹下解压的文件？"><a href="#如何删除意外在当前文件夹下解压的文件？" class="headerlink" title="如何删除意外在当前文件夹下解压的文件？"></a>如何删除意外在当前文件夹下解压的文件？</h4><p>我意外在/var/www/html/而不是/home/projects/www/current下解压了一个tarball。它搞乱了/var/www/html下的文件，你甚至不知道哪些是误解压出来的。最简单修复这个问题的方法是：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cd /var/www/html/</div><div class="line">/bin/rm -f &quot;$(tar ztf /path/to/file.tar.gz)&quot;</div></pre></td></tr></table></figure><p></p><h4 id="跳转cd"><a href="#跳转cd" class="headerlink" title="跳转cd"></a>跳转cd</h4><figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="comment">#快速回到根目录：</span></div><div class="line">cd</div><div class="line"><span class="comment">#返回上一个跳转前路径：</span></div><div class="line">cd -</div></pre></td></tr></table></figure><h4 id="将文件复制到多个目录中"><a href="#将文件复制到多个目录中" class="headerlink" title="将文件复制到多个目录中"></a>将文件复制到多个目录中</h4><figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="comment">#不必运行：</span></div><div class="line"><span class="comment">#cp /path/to/file /usr/dir1</span></div><div class="line"><span class="comment">#cp /path/to/file /var/dir2</span></div><div class="line"><span class="comment">#cp /path/to/file /nas/dir3</span></div><div class="line"><span class="comment">#只需要运行下面的命令来复制文件到多个目录中：</span></div><div class="line"><span class="keyword">echo</span> /usr/dir1 /<span class="keyword">var</span>/dir2 /nas/dir3 | xargs -n <span class="number">1</span> cp -v /path/to/file</div></pre></td></tr></table></figure><h4 id="快速找出两个目录的不同"><a href="#快速找出两个目录的不同" class="headerlink" title="快速找出两个目录的不同"></a>快速找出两个目录的不同</h4><p>diff命令会按行比较文件。但是它也可以比较两个目录：<br></p><figure class="highlight php"><table><tr><td class="code"><pre><div class="line"><span class="comment">#ls -l /tmp/r</span></div><div class="line"><span class="comment">#ls -l /tmp/s</span></div><div class="line"><span class="comment"># 使用 diff 比较两个文件夹</span></div><div class="line">diff /tmp/r/ /tmp/s/</div></pre></td></tr></table></figure><p></p><h4 id="echo显示带颜色-需要使用参数-e"><a href="#echo显示带颜色-需要使用参数-e" class="headerlink" title="echo显示带颜色,需要使用参数-e"></a>echo显示带颜色,需要使用参数-e</h4><p>-n 不输出换行符<br>-e 打开反斜杠ESC转义<br>-E 取消反斜杠ESC转义 (默认)<br>格式如下:<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">echo -e &quot;\033[字背景颜色;文字颜色m字符串\033[0m&quot;</div><div class="line"># 例如: </div><div class="line">echo -e &quot;\033[41;37m TonyZhang \033[0m&quot;</div></pre></td></tr></table></figure><p></p><p>其中41的位置代表底色, 37的位置是代表字的颜色<br>注：<br>1、字背景颜色和文字颜色之间是英文的“”””<br>2、文字颜色后面有个m<br>3、字符串前后可以没有空格，如果有的话，输出也是同样有空格<br>下面看几个例子：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">echo -e &quot;\033[30m 黑色字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[31m 红色字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[32m 绿色字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[33m 黄色字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[34m 蓝色字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[35m 紫色字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[36m 天蓝字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[37m 白色字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[40;37m 黑底白字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[41;37m 红底白字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[42;37m 绿底白字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[43;37m 黄底白字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[44;37m 蓝底白字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[45;37m 紫底白字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[46;37m 天蓝底白字 \033[0m&quot;</div><div class="line">echo -e &quot;\033[47;30m 白底黑字 \033[0m&quot;</div></pre></td></tr></table></figure><p></p><p>控制选项说明 ：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">\33[0m 关闭所有属性 </div><div class="line">\33[1m 设置高亮度 </div><div class="line">\33[4m 下划线 </div><div class="line">\33[5m 闪烁 </div><div class="line">\33[7m 反显 </div><div class="line">\33[8m 消隐 </div><div class="line">\33[30m -- \33[37m 设置前景色 </div><div class="line">\33[40m -- \33[47m 设置背景色 </div><div class="line">\33[nA 光标上移n行 </div><div class="line">\33[nB 光标下移n行 </div><div class="line">\33[nC 光标右移n行 </div><div class="line">\33[nD 光标左移n行 </div><div class="line">\33[y;xH设置光标位置 </div><div class="line">\33[2J 清屏 </div><div class="line">\33[K 清除从光标到行尾的内容 </div><div class="line">\33[s 保存光标位置 </div><div class="line">\33[u 恢复光标位置 </div><div class="line">\33[?25l 隐藏光标 </div><div class="line">\33[?25h 显示光标</div></pre></td></tr></table></figure><p></p><h3 id="批量上传文件"><a href="#批量上传文件" class="headerlink" title="批量上传文件"></a>批量上传文件</h3><p>一，scp上传不要输入密码<br>如果要用scp来上传文件，第一步就要去掉scp上传时要输入密码。要不然就没办法批量上传了。具体请参考：ssh 不用输入密码<br>二，ssh批量上传脚本<br>1,要上传的文件列表放到一个test文件中<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">root@ubuntu:/home/zhangy# cat test  </div><div class="line">/home/zhangy/test/aaa  </div><div class="line">/home/zhangy/test/nginx.conf  </div><div class="line">  </div><div class="line">/home/zhangy/test/test.sql  </div><div class="line">/home/zhangy/test/pa.txt  </div><div class="line">/home/zhangy/test/password</div></pre></td></tr></table></figure><p></p><p>上面就要上传的文件。<br>2,批量上传的脚本<br><code>vim file_upload.sh</code><br>查看复制打印?<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">#!/bin/sh  </div><div class="line">  </div><div class="line">DATE=`date +%Y_%m_%d_%H`  </div><div class="line">  </div><div class="line">if [ $1 ]  </div><div class="line">then  </div><div class="line">  for file in $(sed &apos;/^$/d&apos; $1)     //去掉空行  </div><div class="line">  do  </div><div class="line">    if [ -f $file ]                 //普通文件  </div><div class="line">    then  </div><div class="line">      res=`scp $file $2:$file`      //上传文件  </div><div class="line">      if [ -z $res ]                //上传成功  </div><div class="line">      then  </div><div class="line">        echo $file &gt;&gt; $&#123;DATE&#125;_upload.log   //上传成功的日志  </div><div class="line">      fi  </div><div class="line">    elif [ -d $file ]              //目录  </div><div class="line">    then  </div><div class="line">      res=`scp -r $file $2:$file`  </div><div class="line">      if [ -z $res ]  </div><div class="line">      then  </div><div class="line">        echo $file &gt;&gt; $&#123;DATE&#125;_upload.log  </div><div class="line">      fi  </div><div class="line">    fi  </div><div class="line">  done  </div><div class="line">else  </div><div class="line">  echo &quot;no file&quot; &gt;&gt; $&#123;DATE&#125;_error.log  </div><div class="line">fi</div></pre></td></tr></table></figure><p></p><p>上传成功后，返回的是一个空行，上传不成功，什么都不返回<br>3，上传的格式<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">./file_upload.sh test 192.168.1.13</div></pre></td></tr></table></figure><p></p><p>test是上传列表文件，192.168.1.13文件要传到的地方.</p><h4 id="uuid"><a href="#uuid" class="headerlink" title="uuid"></a>uuid</h4><p>在提到这个之前，有个概念，就是什么是uuid呢？<br>UUID码全称是通用唯一识别码 (Universally Unique Identifier, UUID),它 是一个软件建构的标准，亦为自由软件基金会 (Open Software Foundation, OSF) 的组织在分布式计算环境 (Distributed Computing Environment, DCE) 领域的一部份。<br>UUID 的目的，是让分布式系统中的所有元素，都能有唯一的辨识信息，而不需要通过中央控制端来做辨识信息的指定。如此一来，每个人都可以创建不与其它人冲突的 UUID。在这样的情况下，就不需考虑数据库创建时的名称重复问题。它会让网络任何一台计算机所生成的uuid码，都是互联网整个服务器网络中唯一的。它的原信息会加入硬件，时间，机器当前运行信息等等。<br>UUID格式是：包含32个16进位数字，以“-”连接号分为五段，形式为8-4-4-4-12的32个字符。范例；550e8400-e29b-41d4-a716-446655440000 ,所以：UUID理论上的总数为216 x 8=2128，约等于3.4 x 1038。 也就是说若每奈秒产生1兆个UUID，要花100亿年才会将所有UUID用完。<br>其实，大家做数据库设计时候，肯定听说过，guid(全局唯一标识符)码，它其实是与uuid类似，由微软支持。 这里编码，基本有操作系统内核产生。大家记得把，在windows里面，无论数据库，还是其它软件，很容易得到这个uuid编码。<br>linux 的uuid码<br>linux的uuid码也是有内核提供的，在/proc/sys/kernel/random/uuid这个文件内。其实，random目录，里面还有很多其它文件，都与生成uuid有关系的。<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[chengmo@centos5 ~/shell]$ cat /proc/sys/kernel/random/uuid</div><div class="line">dff68213-b700-4947-87b1-d9e640334196</div><div class="line">[chengmo@centos5 ~/shell]$ cat /proc/sys/kernel/random/uuid</div><div class="line">7b57209a-d285-4fd0-88b4-9d3162d2e1bc</div><div class="line">#连续2次读取，得到的uuid是不同的</div><div class="line"> </div><div class="line">[chengmo@centos5 ~/shell]$ cat /proc/sys/kernel/random/uuid| cksum | cut -f1 -d&quot; &quot;</div><div class="line">2141807556</div><div class="line">#同上方法得到随机整数</div></pre></td></tr></table></figure><p></p></div><footer><div class="clearfix"></div></footer></article><div class="comments" id="comments"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7/dist/Valine.min.js"></script><script>new Valine({av:AV,el:".comments",verify:!0,app_id:"58Gw4yI8F0oqW6c8XmlSf41L-gzGzoHsz",app_key:"x9x1YOCqBJlFS4cCmNEQNhgg",placeholder:"--有问题请留言--"})</script></div></div><footer id="footer"><div class="copyright">&copy; 2017 <a href="/">(^_^)</a></div><div class="theme-copyright"><a href="javascript:scroll(0,0)">返回顶部</a></div><div class="clearfix"></div></footer><script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/all.js"></script><script type="text/javascript">$(document).ready(function(){$(document).on("click",".fold_hider",function(){$(">.fold",this.parentNode).slideToggle(),$(">:first",this).toggleClass("open")}),$("div.fold").css("display","none")}),daovoice("init",{app_id:"e7a17939"}),daovoice("update")</script></body><!-- rebuild by neat -->