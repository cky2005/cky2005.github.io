<!-- build time:Sat Aug 26 2017 19:42:14 GMT+0800 (中国标准时间) --><!DOCTYPE HTML><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="chrome=1"><title>git使用方法&amp;远程仓库同步到网站web目录 | 无名小站</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="author" content="(^_^)"><meta name="description" content="服务端操作："><meta name="description" content="服务端操作："><meta name="keywords" content="vps"><meta property="og:type" content="article"><meta property="og:title" content="git使用方法&amp;远程仓库同步到网站web目录"><meta property="og:url" content="http://cky2005.github.com/2017/08/21/test8/index.html"><meta property="og:site_name" content="无名小站"><meta property="og:description" content="服务端操作："><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2017-08-25T03:43:49.635Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="git使用方法&amp;远程仓库同步到网站web目录"><meta name="twitter:description" content="服务端操作："><link rel="icon" type="image/x-icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/style.css"><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--></head></html><body><div class="wrapper"><header id="header"><div class="title"><h1><a href="/">无名小站</a></h1><p><a href="/">缘来系你</a></p></div><nav class="nav"><ul><li><a href="/">首页</a></li><li><a href="/archives">档案</a></li></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div class="content"><article class="post"><header><div class="icon"></div><a href="/2017/08/21/test8/"><time datetime="2017-08-21T02:12:00.000Z">2017-08-21</time></a><h1 class="title">git使用方法&amp;远程仓库同步到网站web目录</h1></header><div class="entry"><p>服务端操作：<br><a id="more"></a><br>1、新建裸仓库：<br></p><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">git init --bare sample.git</div></pre></td></tr></table></figure><p></p><p>2、使用git钩子：<br></p><figure class="highlight php"><table><tr><td class="code"><pre><div class="line">cd /sample.git/hooks/</div><div class="line"><span class="comment">//这里我们创建post-receive文件</span></div><div class="line">vim post-receive</div><div class="line"><span class="comment">//在该文件里输入以下内容</span></div><div class="line"><span class="comment">#!/bin/bash</span></div><div class="line">git --work-tree=/home/www checkout -f</div><div class="line"><span class="comment">//保存退出后，将该文件用户及用户组都设置成git</span></div><div class="line">chown git:git post-receive</div><div class="line"><span class="comment">//由于该文件其实就是一个shell文件，我们还应该为其设置可执行权限</span></div><div class="line">chmod +x post-receive</div></pre></td></tr></table></figure><p></p><hr><h3 id="另外一个post-receive-这个自动获取目录信息不需要自己指定"><a href="#另外一个post-receive-这个自动获取目录信息不需要自己指定" class="headerlink" title="另外一个post-receive,这个自动获取目录信息不需要自己指定"></a>另外一个post-receive,这个自动获取目录信息不需要自己指定</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line">DIR=`<span class="built_in">cd</span> $(dirname <span class="variable">$0</span>); <span class="built_in">pwd</span>`</div><div class="line">WORKING=<span class="string">"<span class="variable">$DIR</span>/../../"</span></div><div class="line">GIT=<span class="string">"<span class="variable">$DIR</span>/../"</span></div><div class="line">git --work-tree=<span class="variable">$WORKING</span> --git-dir=<span class="variable">$GIT</span> checkout -f</div></pre></td></tr></table></figure><hr><h2 id="git-使用方法-纪录"><a href="#git-使用方法-纪录" class="headerlink" title="git 使用方法 纪录"></a>git 使用方法 纪录</h2><h3 id="一、代码上传"><a href="#一、代码上传" class="headerlink" title="一、代码上传"></a>一、代码上传</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">（1）git init : 初始化git仓库</div><div class="line">（2）git add --all / git add . 添加本地文件到暂存区</div><div class="line">（3）git commit -m “你的注释” 添加本地文件到版本库</div><div class="line">（4）git remote add origin https://git.coding.net/ckq/dianshang.git 添加远程仓库地址</div><div class="line">（5）git push origin master 向远程仓库推送代码</div></pre></td></tr></table></figure><h3 id="二、代码下载"><a href="#二、代码下载" class="headerlink" title="二、代码下载"></a>二、代码下载</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">（1）直接克隆 ：git <span class="built_in">clone</span> https://git.coding.net/ckq/dianshang.git 克隆远程代码</div><div class="line">（2）抓取 ：· git init 初始化git仓库</div><div class="line">· git remote add origin https://git.coding.net/ckq/dianshang.git 添加远程仓库地址</div><div class="line">· git fetch origin master 抓取远程仓库代码（只有主支）</div><div class="line">· git merge origin/master 合并到本地仓库</div></pre></td></tr></table></figure><h3 id="三、分支管理"><a href="#三、分支管理" class="headerlink" title="三、分支管理"></a>三、分支管理</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">git checkout -b dev ：创建一个名叫dev 的分支并切换到此分支</div><div class="line">git branch 查看有几条分支</div><div class="line">git checkout dev 切换到dev 分支</div><div class="line">git branch -m oldname newname 更换分支名称</div><div class="line">git merge dev 合并分支（要切换到要合并它的分支上，如 ：master）</div><div class="line">git branch -d dev 删除当前分支（强制删除：-D）</div></pre></td></tr></table></figure><h3 id="四、暂存（隐藏）当前分支"><a href="#四、暂存（隐藏）当前分支" class="headerlink" title="四、暂存（隐藏）当前分支"></a>四、暂存（隐藏）当前分支</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">git stash 隐藏当前分支，相当于暂存</div><div class="line">git stash list 列所有stash</div><div class="line">git stash apply 恢复暂存的内容</div><div class="line">git stash drop 删除暂存区</div></pre></td></tr></table></figure><h5 id="多人合作"><a href="#多人合作" class="headerlink" title="多人合作"></a>多人合作</h5><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">情况一：本地没有项目,我想克隆一个（包括主分支和次分支）</div><div class="line">（1）项目克隆：</div><div class="line">       git <span class="built_in">clone</span> ....</div><div class="line">（2）建立次分支：</div><div class="line">       git checkout -b dev origin/dev</div><div class="line">（3）本地分支和远程分支进行连接：</div><div class="line">       git branch --<span class="built_in">set</span>-upstream-to origin/dev dev</div><div class="line">情况二：本地没有项目,我只想抓取远程次分支</div><div class="line">（1）建立一个本地库文件夹（最好与远程一致）</div><div class="line">（2）初始化本地仓库：</div><div class="line">       git init</div><div class="line">（3）建立本地与远程之间的连接：</div><div class="line">       git remote add origin https://git.coding.net/ckq/dianshang.git</div><div class="line">（4）抓取次分支：</div><div class="line">       git fetch origin dev</div><div class="line">（5）合并到本地：</div><div class="line">       git merge origin/dev</div><div class="line">git checkout -b branch-name origin/branch-name : 在本地创建和远程分支对应的分支</div><div class="line">git push origin branch-name : 可以试图推送自己的修改；</div><div class="line">git pull : 如果推送失败，则因为远程分支比你的本地更新，需要先用试图合并</div><div class="line">如果合并有冲突，则解决冲突，并在本地提交；</div><div class="line">没有冲突或者解决掉冲突后，再用git push origin branch-name推送就能成功！</div><div class="line">如果git pull提示“no tracking information”，则说明本地分支和远程分支的链接关系没有创建，</div><div class="line">用命令git branch --<span class="built_in">set</span>-upstream-to origin/dev dev。</div></pre></td></tr></table></figure><h3 id="五、版本回退"><a href="#五、版本回退" class="headerlink" title="五、版本回退"></a>五、版本回退</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">git reflog : 显示回退的id</div><div class="line">git reset --hard commit-id 回到想要回退的版本</div><div class="line">git reset --hard HEAD^^/git reset --hard HEAD~回退到上一个版本</div><div class="line">git reset HEAD~5 撤销过去5个commit的命令，然后在添加提交</div></pre></td></tr></table></figure><h3 id="六、其他命令"><a href="#六、其他命令" class="headerlink" title="六、其他命令"></a>六、其他命令</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">（1）git --version 查看当前git版本</div><div class="line">（2）git <span class="built_in">help</span> --all 查看git命令</div><div class="line">（3）git diff 查看当前工作区域版本库有哪些区别，修改了什么内容</div><div class="line">（4）git status 查看仓库当前状态</div><div class="line">（5）git <span class="built_in">log</span> 查看提交的历史记录</div><div class="line">（6）git <span class="built_in">log</span> --pretty=oneline 当前记录在一行显示</div><div class="line">（7）git reflog 查看所有分支的所有操作记录(包括commit和reset),包括已经被删除的commit记录</div><div class="line">（8）git pull 更新本地仓库</div><div class="line">（9）git remote -v 查看远程信息库pull和fetch详细信息</div><div class="line">（10）git branch -r查看远程分支</div><div class="line">（11）git branch -a查看所有分支</div><div class="line">（12）git push --force origin dev 强制推荐dev分支(rebase后的分支历史改变了,可能导致不兼容现象)</div><div class="line">（13）git remote rm 删除远程仓库</div><div class="line">（14）git remote show origin 查看远程仓库的信息</div></pre></td></tr></table></figure><p><a href="https://tzwe.com" target="_blank" rel="external">来源1</a> <a href="https://www.v2ex.com/t/384343#reply12" target="_blank" rel="external">来源2</a></p></div><footer><div class="tags"><a class="tags-link" href="/tags/vps/">vps</a></div><div class="clearfix"></div></footer></article></div></div><footer id="footer"><div class="copyright">&copy; 2017 <a href="/">(^_^)</a></div><div class="theme-copyright">Theme by <a href="https://github.com/orderedlist" target="_blank">orderedlist</a> | Redesign by <a href="http://heroicyang.com/" target="_blank">Heroic Yang</a></div><div class="clearfix"></div></footer><script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/scale.fix.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script></body><!-- rebuild by neat -->