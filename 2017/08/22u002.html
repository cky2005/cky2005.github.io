<!-- build time:Fri Jan 18 2019 14:56:48 GMT+0800 (GMT+08:00) --><!DOCTYPE HTML><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="chrome=1"><title>一些linux命令 | 唔多阁</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="author" content="(^_^)"><meta name="description" content="页首修改vps默认ssh端口22取消sshd的反向DNS解析删除某个软件包保存/读出 iptables 规则查看服务器登陆信息服务器默认端口Linux 常用命令修改服务器时间"><meta name="description" content="页首修改vps默认ssh端口22取消sshd的反向DNS解析删除某个软件包保存/读出 iptables 规则查看服务器登陆信息服务器默认端口Linux 常用命令修改服务器时间"><meta property="og:type" content="article"><meta property="og:title" content="一些linux命令"><meta property="og:url" content="https://cky2005.github.io/2017/08/22u002.html"><meta property="og:site_name" content="唔多阁"><meta property="og:description" content="页首修改vps默认ssh端口22取消sshd的反向DNS解析删除某个软件包保存/读出 iptables 规则查看服务器登陆信息服务器默认端口Linux 常用命令修改服务器时间"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2017-11-05T12:38:35.453Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="一些linux命令"><meta name="twitter:description" content="页首修改vps默认ssh端口22取消sshd的反向DNS解析删除某个软件包保存/读出 iptables 规则查看服务器登陆信息服务器默认端口Linux 常用命令修改服务器时间"><link rel="icon" type="image/x-icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/style.css"></head></html><body><div class="wrapper"><header id="header"><div class="title"><h1><a href="/">唔多阁</a></h1><p><a href="/">(学习笔记,备忘,纯属复制粘贴,无技术含量)</a></p></div><nav class="nav"><ul></ul><div class="clearfix"></div></nav><div class="clearfix"></div></header><div class="content"><article class="post"><header><div class="icon"></div><a href="/2017/08/22u002.html"><time datetime="2017-08-22T11:33:00.000Z">2017-08-22</time></a><h1 class="title">一些linux命令</h1></header><div class="entry"><p><span id="m0">页首</span></p><ul><li><a href="#m1">修改vps默认ssh端口22</a></li><li><a href="#m3">取消sshd的反向DNS解析</a></li><li><a href="#m2">删除某个软件包</a></li><li><a href="#mm2">保存/读出 iptables 规则</a></li><li><a href="#m3">查看服务器登陆信息</a></li><li><a href="#m4">服务器默认端口</a></li><li><a href="#m5">Linux 常用命令</a></li><li><a href="#m6">修改服务器时间</a><a id="more"></a></li></ul><p></p><h2 id="m1">修改vps默认ssh端口22</h2><br>更改配置前备份<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cp /etc/ssh/sshd_config /etc/ssh/sshd_config.ori</span><br></pre></td></tr></table></figure><p></p><p>vi编辑配置文件<br></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config</span><br><span class="line">port <span class="number">22</span> <span class="comment">//把默认的`22`改为其它</span></span><br></pre></td></tr></table></figure><p></p><p>重启ssh服务使新配置生效<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo service sshd restart</span><br></pre></td></tr></table></figure><p></p><hr><p></p><h2 id="m3">取消sshd的反向DNS解析</h2><br>SSH 登录太慢可能是 DNS 解析的问题，默认配置下 sshd 初次接受 ssh 客户端连接的时候<br>会自动反向解析客户端 IP 以得到 ssh 客户端的域名或主机名。如果这个时候 DNS 的反向解析不正确，<br>sshd 就会等到 DNS 解析超时后才提供 ssh 连接，这样就造成连接时间过长、ssh 客户端等待的情况，<br>一般为10-30秒左右.有个简单的解决办法就是在sshd的配置文件(sshd_config)里取消sshd的反向DNS解析.<p></p><p>vi编辑配置文件<br></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config</span><br><span class="line">UseDNS no <span class="comment">//修改为no</span></span><br></pre></td></tr></table></figure><p></p><p>重启SSH服务<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/etc/init.d/sshd restart</span><br></pre></td></tr></table></figure><p></p><hr><p></p><h2 id="m2">删除某个软件包</h2><br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">dpkg --<span class="keyword">list</span> <span class="comment">//列出所有安装软件包</span></span><br><span class="line">cd /etc/init.d/</span><br><span class="line">sudo apt-get --purge remove xxxx <span class="comment">//删除xxxx软件包</span></span><br></pre></td></tr></table></figure><p></p><p><a href="#m0">返回页首</a></p><hr><p></p><h2 id="mm2">保存/读出 iptables 规则</h2><p></p><h4 id="保存规则到配置文件"><a href="#保存规则到配置文件" class="headerlink" title="保存规则到配置文件"></a>保存规则到配置文件</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Debian/Ubuntu: iptables-save &gt; /etc/iptables/rules.v4</span><br><span class="line">RHEL/CentOS:    iptables-save &gt; /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure><h4 id="开机启动iptables配置文件规则"><a href="#开机启动iptables配置文件规则" class="headerlink" title="开机启动iptables配置文件规则"></a>开机启动iptables配置文件规则</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Debian/Ubuntu: iptables-restore &lt; /etc/iptables/rules.v4</span><br><span class="line">RHEL/CentOS: iptables-restore &lt; /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure><p>从 Ubuntu 10.04 LTS (Lucid) 和 Debian 6.0 (Squeeze) 版本开始，可以通过安装<br>一个名为 “iptables-persistent” 的包，安装后它以守护进程的方式来运行，系统重启<br>后可以自动将保存的内容加载到iptables中。当然前提也是需要先保存规则。<br><a href="#m0">返回页首</a></p><hr><p></p><h2 id="m3">查看服务器登陆信息</h2><br>last命令，对应的日志文件/var/log/wtmp； 成功登录用户<br>lastb命令，对应的日志文件/var/log/btmp； 尝试登录信息<br>lastlog命令，对应的日志文件/var/log/lastlog； 显示最近登录信息<p></p><hr><p></p><h2 id="m4">服务器默认端口</h2><br>20和21 FTP上传使用端口<br>25 邮件服务器发邮件端口<br>80 网页访问WEB端口<br>110 邮件服务器接受邮件端口<br>1433 MSSQL数据库远程连接端口<br>3306 MYSQL服务器远程连接端口<br>3389 默认远程桌面连接端口<br>33000-33003 FTP被动模式使用端口<br><a href="#m0">返回页首</a><p></p><hr><p></p><h2 id="m5">Linux 常用命令</h2><br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">系统</span><br><span class="line">uname -a <span class="comment"># 查看内核/操作系统/CPU信息</span></span><br><span class="line">head -n <span class="number">1</span> /etc/issue <span class="comment"># 查看操作系统版本</span></span><br><span class="line">cat /proc/cpuinfo <span class="comment"># 查看CPU信息</span></span><br><span class="line">hostname <span class="comment"># 查看计算机名</span></span><br><span class="line">lspci -tv <span class="comment"># 列出所有PCI设备</span></span><br><span class="line">lsusb -tv <span class="comment"># 列出所有USB设备</span></span><br><span class="line">lsmod <span class="comment"># 列出加载的内核模块</span></span><br><span class="line">env <span class="comment"># 查看环境变量</span></span><br><span class="line">资源</span><br><span class="line">free -m <span class="comment"># 查看内存使用量和交换区使用量</span></span><br><span class="line">df -h <span class="comment"># 查看各分区使用情况</span></span><br><span class="line">du -sh <span class="comment"># 查看指定目录的大小</span></span><br><span class="line">grep MemTotal /proc/meminfo <span class="comment"># 查看内存总量</span></span><br><span class="line">grep MemFree /proc/meminfo <span class="comment"># 查看空闲内存量</span></span><br><span class="line">uptime <span class="comment"># 查看系统运行时间、用户数、负载</span></span><br><span class="line">cat /proc/loadavg <span class="comment"># 查看系统负载</span></span><br><span class="line">磁盘和分区</span><br><span class="line">mount | column -t <span class="comment"># 查看挂接的分区状态</span></span><br><span class="line">fdisk -l <span class="comment"># 查看所有分区</span></span><br><span class="line">swapon -s <span class="comment"># 查看所有交换分区</span></span><br><span class="line">hdparm -i /dev/hda <span class="comment"># 查看磁盘参数(仅适用于IDE设备)</span></span><br><span class="line">dmesg | grep IDE <span class="comment"># 查看启动时IDE设备检测状况</span></span><br><span class="line">网络</span><br><span class="line">ifconfig <span class="comment"># 查看所有网络接口的属性</span></span><br><span class="line">iptables -L <span class="comment"># 查看防火墙设置</span></span><br><span class="line">route -n <span class="comment"># 查看路由表</span></span><br><span class="line">netstat -lntp <span class="comment"># 查看所有监听端口</span></span><br><span class="line">netstat -antp <span class="comment"># 查看所有已经建立的连接</span></span><br><span class="line">netstat -s <span class="comment"># 查看网络统计信息</span></span><br><span class="line">进程</span><br><span class="line">ps -ef <span class="comment"># 查看所有进程</span></span><br><span class="line">top <span class="comment"># 实时显示进程状态</span></span><br><span class="line">用户</span><br><span class="line">w <span class="comment"># 查看活动用户</span></span><br><span class="line">id &lt;用户名&gt; <span class="comment"># 查看指定用户信息</span></span><br><span class="line">last <span class="comment"># 查看用户登录日志</span></span><br><span class="line">cut -d: -f1 /etc/passwd <span class="comment"># 查看系统所有用户</span></span><br><span class="line">cut -d: -f1 /etc/group <span class="comment"># 查看系统所有组</span></span><br><span class="line">crontab -l <span class="comment"># 查看当前用户的计划任务</span></span><br><span class="line">服务</span><br><span class="line">chkconfig <span class="keyword">list</span> <span class="comment"># 列出所有系统服务</span></span><br><span class="line">chkconfig <span class="keyword">list</span> | grep on <span class="comment"># 列出所有启动的系统服务程序</span></span><br><span class="line">rpm -qa <span class="comment"># 查看所有安装的软件包</span></span><br></pre></td></tr></table></figure><p></p><p><a href="#m0">返回页首</a></p><hr><p></p><h2 id="m6">修改服务器时间</h2><br>用软件包去对时网站获取准确时间<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">apt-get install ntpdate <span class="comment">#安装更新时间软件包</span></span><br><span class="line">ntpdate time.windows.com <span class="comment">#ntpdate 对时网址</span></span><br></pre></td></tr></table></figure><p></p><p>修改服务器时区为上海<br></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">rm -rf /etc/localtime <span class="comment">#先删除默认的时区设置</span></span><br><span class="line">ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime <span class="comment">#替换上海/北京作为默认</span></span><br><span class="line">ln -s /usr/share/zoneinfo/Asia/Hong_Kong /etc/localtime</span><br></pre></td></tr></table></figure><p></p><p>手动修改日期时间<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">date -s &apos;20:20:25&apos; &apos;2017-09-28&apos;</span><br></pre></td></tr></table></figure><p></p><p><a href="#m0">返回页首</a></p><p>apt-get<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">　　apt-cache search package 搜索包</span><br><span class="line"></span><br><span class="line">　　apt-cache show package 获取包的相关信息，如说明、大小、版本等</span><br><span class="line"></span><br><span class="line">　　sudo apt-get install package 安装包</span><br><span class="line"></span><br><span class="line">　　sudo apt-get install package - - reinstall 重新安装包</span><br><span class="line"></span><br><span class="line">　　sudo apt-get -f install 修复安装&quot;-f = --fix-missing&quot;</span><br><span class="line"></span><br><span class="line">　　sudo apt-get remove package 删除包</span><br><span class="line"></span><br><span class="line">　　sudo apt-get remove package - - purge 删除包，包括删除配置文件等</span><br><span class="line"></span><br><span class="line">　　sudo apt-get update 更新源</span><br><span class="line"></span><br><span class="line">　　sudo apt-get upgrade 更新已安装的包</span><br><span class="line"></span><br><span class="line">　　sudo apt-get dist-upgrade 升级系统</span><br><span class="line"></span><br><span class="line">　　sudo apt-get dselect-upgrade 使用 dselect 升级</span><br><span class="line"></span><br><span class="line">　　apt-cache depends package 了解使用依赖</span><br><span class="line"></span><br><span class="line">　　apt-cache rdepends package 是查看该包被哪些包依赖</span><br><span class="line"></span><br><span class="line">　　sudo apt-get build-dep package 安装相关的编译环境</span><br><span class="line"></span><br><span class="line">　　apt-get source package 下载该包的源代码</span><br><span class="line"></span><br><span class="line">　　sudo apt-get clean &amp;&amp; sudo apt-get autoclean 清理无用的包</span><br><span class="line"></span><br><span class="line">　　sudo apt-get check 检查是否有损坏的依赖</span><br><span class="line"></span><br><span class="line">　　其中：</span><br><span class="line"></span><br><span class="line">　　1 有SUDO的表示需要管理员特权!</span><br><span class="line"></span><br><span class="line">　　2 在UBUNTU中命令后面参数为短参数是用“-”引出，长参数用“--”引出</span><br><span class="line"></span><br><span class="line">　　3 命令帮助信息可用man 命令的方式查看或者</span><br><span class="line"></span><br><span class="line">　　命令 -H(--help)方式查看</span><br></pre></td></tr></table></figure><p></p></div><footer><div class="clearfix"></div></footer></article></div></div><footer id="footer"><div class="copyright">&copy; 2019 <a href="/">(^_^)</a></div><div class="theme-copyright"><a href="javascript:scroll(0,0)">返回顶部</a><a href="/archives/index.html">档案馆</a><a href="/index.html">首页</a></div><div class="clearfix"></div></footer><script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script><script src="/js/all.js"></script><script type="text/javascript">$(document).ready(function(){$(document).on("click",".fold_hider",function(){$(">.fold",this.parentNode).slideToggle(),$(">:first",this).toggleClass("open")}),$("div.fold").css("display","none")})</script></body><!-- rebuild by neat -->